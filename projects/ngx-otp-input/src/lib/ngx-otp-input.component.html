<div
  class="ngx-otp-input-root"
  role="group"
  [attr.aria-label]="ariaLabel"
  (mousedown)="handleContainerMouseDown($event)"
  data-testid="ngx-otp-input-root"
>
  <input
    #otpInput
    class="ngx-otp-input-native"
    [type]="inputType"
    [disabled]="isDisabled"
    [inputMode]="inputMode"
    [attr.pattern]="patternAttribute"
    [attr.maxlength]="resolvedLength"
    name="one-time-code"
    autocomplete="one-time-code"
    autocapitalize="off"
    autocorrect="off"
    spellcheck="false"
    [attr.aria-invalid]="status === 'error' || hasInvalidOtp ? 'true' : null"
    [attr.aria-describedby]="statusMessage ? statusMessageId : null"
    (input)="handleInput($event)"
    (keydown)="handleKeyDown($event)"
    (paste)="handlePaste($event)"
    (blur)="handleBlur()"
    data-testid="ngx-otp-input-native"
  />

  <div
    class="ngx-otp-input-form"
    aria-hidden="true"
  >
    @for (i of boxes; track i) {
      <div
        class="ngx-otp-input-box"
        [class.ngx-otp-input-disabled]="isDisabled"
        [class.ngx-otp-input-filled]="characters[i]"
        [class.ngx-otp-input-success]="status === 'success'"
        [class.ngx-otp-input-failed]="status === 'error'"
        [class.ngx-otp-input-active]="i === activeIndex && !isDisabled"
        (mousedown)="handleBoxMouseDown($event, i)"
        data-testid="ngx-otp-input-box"
      >
        {{ displayCharacters[i] }}
      </div>
    }
  </div>

  <span
    [id]="statusMessageId"
    class="ngx-otp-input-status"
    role="status"
    aria-live="polite"
    aria-atomic="true"
  >
    {{ statusMessage }}
  </span>
</div>
